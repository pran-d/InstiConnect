{"ast":null,"code":"const jwt = require(\"jsonwebtoken\");\n\nconst config = process.env;\n\nconst verifyToken = (req, res, next) => {\n  const token = req.body.token || req.query.token || req.headers[\"x-access-token\"];\n\n  if (!token) {\n    return res.status(403).send(\"A token is required for authentication\");\n  }\n\n  try {\n    const decoded = jwt.verify(token, config.TOKEN_KEY);\n    req.user = decoded;\n  } catch (err) {\n    return res.status(401).send(\"Invalid Token\");\n  }\n\n  return next();\n};\n\nmodule.exports = verifyToken;","map":{"version":3,"names":["jwt","require","config","process","env","verifyToken","req","res","next","token","body","query","headers","status","send","decoded","verify","TOKEN_KEY","user","err","module","exports"],"sources":["C:/Users/maste/OneDrive/Desktop/WebDev/InstiConnect/client/src/middleware/auth.js"],"sourcesContent":["const jwt = require(\"jsonwebtoken\");\r\n\r\nconst config = process.env;\r\n\r\nconst verifyToken = (req, res, next) => {\r\n\tconst token = req.body.token || req.query.token || req.headers[\"x-access-token\"];\r\n\r\n\tif (!token) {\r\n\t\treturn res.status(403).send(\"A token is required for authentication\");\r\n\t}\r\n\ttry {\r\n\t\tconst decoded = jwt.verify(token, config.TOKEN_KEY);\r\n\t\treq.user = decoded;\r\n\t} catch (err) {\r\n\t\treturn res.status(401).send(\"Invalid Token\");\r\n\t}\r\n\treturn next();\r\n};\r\n\r\nmodule.exports = verifyToken;\r\n"],"mappings":"AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEA,MAAMC,MAAM,GAAGC,OAAO,CAACC,GAAvB;;AAEA,MAAMC,WAAW,GAAG,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,KAAoB;EACvC,MAAMC,KAAK,GAAGH,GAAG,CAACI,IAAJ,CAASD,KAAT,IAAkBH,GAAG,CAACK,KAAJ,CAAUF,KAA5B,IAAqCH,GAAG,CAACM,OAAJ,CAAY,gBAAZ,CAAnD;;EAEA,IAAI,CAACH,KAAL,EAAY;IACX,OAAOF,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,wCAArB,CAAP;EACA;;EACD,IAAI;IACH,MAAMC,OAAO,GAAGf,GAAG,CAACgB,MAAJ,CAAWP,KAAX,EAAkBP,MAAM,CAACe,SAAzB,CAAhB;IACAX,GAAG,CAACY,IAAJ,GAAWH,OAAX;EACA,CAHD,CAGE,OAAOI,GAAP,EAAY;IACb,OAAOZ,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,eAArB,CAAP;EACA;;EACD,OAAON,IAAI,EAAX;AACA,CAbD;;AAeAY,MAAM,CAACC,OAAP,GAAiBhB,WAAjB"},"metadata":{},"sourceType":"module"}